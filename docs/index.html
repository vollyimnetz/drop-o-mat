<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <title>drop-o-mat</title>
        <base href="/drop-o-mat/" />
        <link rel="manifest" href="generated/manifest.json" />
        <link href="generated/vendor.css" rel="stylesheet">
        <link href="generated/main.css" rel="stylesheet">
    </head>

    <body>
        <script>
            window.mywebapp = {
                "appName": "drop-o-mat",
                "plugin_url": "https://vollyimnetz.github.io/drop-o-mat",//needed for service worker
            };
        </script>
        <div id="app"></div>

        <!-- BUTTON add to homescreen -->
        <button class="addToHomescreenButton">Add to home screen</button>
        <script>
        /*** START add to homescreen ***/
        let deferredPrompt;
        const addBtn = document.querySelector('.addToHomescreenButton');
        addBtn.style.display = 'none';

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;
            // Update UI to notify the user they can add to home screen
            addBtn.style.display = 'block';

            addBtn.addEventListener('click', (e) => {
                // hide our user interface that shows our addToHomescreen button
                addBtn.style.display = 'none';
                // Show the prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the addToHomescreen prompt');
                    } else {
                        console.log('User dismissed the addToHomescreen prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });
        /*** END add to homescreen ***/
        </script>
        
        <script type="text/javascript" src="generated/vendor.js"></script>
        <script type="text/javascript" src="generated/main.js"></script>
    </body>
</html>